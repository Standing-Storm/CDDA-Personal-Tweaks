[
  {
    "type": "SPELL",
    "id": "arcana_item_charm_bone_empowered",
    "name": { "str": "Stunning Blast" },
    "description": "Blasts nearby targets for heavy damage.",
    "valid_targets": [ "ally", "hostile" ],
    "message": "A powerful blast of energy radiates from the charm!",
    "extra_effects": [
      { "id": "arcana_item_charm_bone_empowered_spike", "hit_self": false },
      { "id": "arcana_item_charm_bone_empowered_paralyze", "hit_self": false },
      { "id": "arcana_item_charm_bone_empowered_sleepiness", "hit_self": true }
    ],
    "effect": "attack",
    "shape": "blast",
    "flags": [ "NO_HANDS", "NO_LEGS", "SILENT", "RANDOM_DAMAGE" ],
    "min_damage": 25,
    "max_damage": 50,
    "damage_type": "heat",
    "min_aoe": 8,
    "max_aoe": 8
  },
  {
    "type": "SPELL",
    "id": "arcana_item_charm_bone_empowered_spike",
    "name": { "str": "Stunning Blast Spike" },
    "description": "Doubles the damage for enemies that are close enough.",
    "valid_targets": [ "ally", "hostile" ],
    "message": "",
    "effect": "attack",
    "shape": "blast",
    "flags": [ "NO_HANDS", "NO_LEGS", "SILENT", "RANDOM_DAMAGE" ],
    "min_damage": 25,
    "max_damage": 50,
    "damage_type": "heat",
    "min_aoe": 2,
    "max_aoe": 2
  },
  {
    "id": "arcana_item_charm_bone_empowered_paralyze",
    "type": "SPELL",
    "name": { "str": "Stunning Blast Paralysis" },
    "description": "This makes the enemies brain-zapped for once!",
    "valid_targets": [ "ally", "hostile" ],
    "message": "",
    "flags": [ "NO_HANDS", "NO_LEGS", "SILENT", "RANDOM_DAMAGE" ],
    "effect": "mod_moves",
    "shape": "blast",
    "min_damage": -400,
    "max_damage": -900,
    "min_aoe": 8,
    "max_aoe": 8
  },
  {
    "id": "arcana_react_phase_shield",
    "type": "SPELL",
    "name": { "str": "Phase Shield Effect" },
    "description": "This pushes your attackers away.",
    "valid_targets": [ "ally", "hostile" ],
    "flags": [ "SILENT" ],
    "effect": "effect_on_condition",
    "effect_str": "EOC_ARCANA_REACT_PHASE",
    "shape": "blast",
    "min_aoe": 1
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_REACT_PHASE",
    "condition": "has_alpha",
    "effect": [
      { "npc_location_variable": { "context_val": "player_position" } },
      { "math": [ "_push_nearby_enemies_power_level = n_spell_level('magus_push_nearby_enemies_back')" ] },
      { "math": [ "_telekinesis_weight_ratio = 55" ] },
      {
        "math": [
          "_weight_ratio",
          "=",
          "( (_push_nearby_enemies_power_level * _telekinesis_weight_ratio) + (_telekinesis_weight_ratio / 2) ) / (u_weight() / 1000000)"
        ]
      },
      { "math": [ "_telekinesis_shove_spell_level = clamp( ( (_weight_ratio - 1) * 1.5), 0, 20)" ] },
      {
        "if": { "x_in_y_chance": { "x": { "math": [ "_weight_ratio * 1000" ] }, "y": 1000 } },
        "then": [ { "u_add_effect": "downed", "duration": 2 } ]
      },
      {
        "u_knockback": { "math": [ "_telekinesis_shove_spell_level" ] },
        "stun": 2,
        "dam_mult": { "math": [ "1 + (_telekinesis_shove_spell_level * 0.4)" ] },
        "direction_var": { "context_val": "player_position" }
      }
    ]
  }
]
